@model VlammendVarkenBackend.Models.ViewModels.GerechtViewModel

@{
  var allergenen = Model.Hoofdonderdelen.SelectMany(h => h.Allergenen)
    .Concat(Model.Bijgerechten.SelectMany(b => b.Allergenen))
    .Concat(Model.Groenten.SelectMany(g => g.Allergenen))
    .Concat(Model.Sausen.SelectMany(s => s.Allergenen))
    .GroupBy(a => a.Symbool)
    .Select(g => g.First())
    .ToList();

  var allergenenString = string.Join(",", allergenen.Select(a => a.Symbool));
    
  var totaalBijonderdelenPrijs =
    Model.Hoofdonderdelen.Sum(h => h.Prijs) +
    Model.Bijgerechten.Sum(b => b.Prijs) +
    Model.Groenten.Sum(g => g.Prijs) +
    Model.Sausen.Sum(s => s.Prijs);
}

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Digitaal Menu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet" />
</head>

<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4 font-sans">
  <main class="w-full max-w-6xl bg-white rounded-xl shadow-lg p-6 md:p-8 space-y-8">
    <header>
      <h1 class="text-3xl font-bold text-gray-900 text-center">Digitaal Menu</h1>
    </header>
    <section aria-labelledby="dagmenu-title">
      <div class="bg-indigo-50 border border-indigo-200 p-6 rounded-lg shadow-sm">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
          <div>
            <h2 id="dagmenu-title" class="text-xl font-bold text-indigo-800">@Model.Naam</h2>
            <ul class="mt-2 text-sm text-indigo-700 list-disc list-inside">
              <li><strong>Bijgerecht:</strong> @Model.Bijgerechten.FirstOrDefault()?.Naam</li>
              <li><strong>Groente:</strong> @Model.Groenten.FirstOrDefault()?.Naam</li>
              <li><strong>Saus:</strong> @Model.Sausen.FirstOrDefault()?.Naam</li>
            </ul>
            <p class="mt-2 text-sm text-indigo-700"><strong>Allergieën:</strong>
              @foreach (var allergeen in allergenen)
              {
                <span class="inline-block mr-1">@allergeen.Symbool</span>
              }
            </p>
          </div>
          <div class="text-right mt-4 md:mt-0 flex-shrink-0 md:ml-6">
            <p class="text-2xl font-bold text-indigo-800 mb-2">€@totaalBijonderdelenPrijs.ToString("F2")</p>
            <div class="w-full md:w-auto space-y-2">
              <button 
                      class="toevoegenBtn w-full flex items-center justify-center bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition-transform hover:scale-105"
                      aria-label="Voeg @Model.Naam toe aan bestelling"
                      data-naam="@Model.Naam"
                      data-soort="@Model.Soort"
                      data-bijgerecht="@Model.Bijgerechten.FirstOrDefault()?.Naam"
                      data-groente="@Model.Groenten.FirstOrDefault()?.Naam"
                      data-saus="@Model.Sausen.FirstOrDefault()?.Naam"
                      data-allergenen="@allergenenString"
                      data-prijs="@totaalBijonderdelenPrijs.ToString("F2")">
                <span class="material-icons text-base mr-2" aria-hidden="true">add_shopping_cart</span>
                Toevoegen
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
    <nav aria-label="Hoofd navigatie" class="max-w-md mx-auto bg-white border border-gray-200 rounded-xl shadow-sm p-4 space-y-2">
      @{
        var navItems = new[] {
          new { Url = "/gast/allergenen/index", Icon = "medical_information", Text = "Allergenen Informatie" },
          new { Url = "/gast/gerechten/voorgerecht/index", Icon = "restaurant_menu", Text = "Voorgerechten" },
          new { Url = "/gast/gerechten/hoofdgerecht/index", Icon = "dinner_dining", Text = "Hoofdgerechten" },
          new { Url = "/gast/gerechten/nagerecht/index", Icon = "icecream", Text = "Nagerechten" },
          new { Url = "/besteloverzicht", Icon = "shopping_cart", Text = "Besteloverzicht" }
        };
      }
      @foreach (var item in navItems)
      {
        <a href="@item.Url" class="flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-indigo-50 group">
          <span class="material-icons text-indigo-600 group-hover:scale-110 transition-transform" aria-hidden="true">@item.Icon</span>
          <span class="text-gray-800 font-medium group-hover:text-indigo-800">@item.Text</span>
        </a>
      }
    </nav>
    <section id="besteloverzicht" aria-label="Besteloverzicht">
      <div class="overflow-x-auto">
        <table class="min-w-full table-auto border border-gray-200 rounded-lg overflow-hidden">
          <thead class="bg-gray-100 text-sm text-gray-600 uppercase text-left">
            <tr>
              <th class="px-4 py-3">Naam</th>
              <th class="px-4 py-3">Categorie</th>
              <th class="px-4 py-3">Bijgerecht</th>
              <th class="px-4 py-3">Groente</th>
              <th class="px-4 py-3">Saus</th>
              <th class="px-4 py-3">Allergieën</th>
              <th class="px-4 py-3 text-right">Actie</th>
              <th class="px-4 py-3 text-right">Prijs</th>
            </tr>
          </thead>
          <tbody id="bestelTabel" class="text-sm text-gray-700 divide-y divide-gray-200">
          </tbody>
          <tfoot class="bg-gray-50 font-bold">
            <tr class="border-t-2 border-gray-200">
              <td colspan="7" class="px-4 py-4 text-left">Totaal</td>
              <td id="totaalPrijs" class="px-4 py-4 text-right">€0.00</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>
  </main>
  <script src="@Url.Content("~/js/script.js")" defer></script>
</body>
